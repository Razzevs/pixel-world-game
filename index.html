<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dragon Evolution: Legacy of Agafonov</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #000;
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #0f0c29, #302b63, #24243e);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            transition: opacity 1s;
        }

        .loading-dragon {
            font-size: 120px;
            margin-bottom: 30px;
            animation: dragonFloat 3s infinite ease-in-out;
            filter: drop-shadow(0 0 20px rgba(255, 100, 0, 0.7));
        }

        .loading-bar {
            width: 300px;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
            margin: 20px 0;
            border: 2px solid rgba(255, 215, 0, 0.3);
        }

        .loading-progress {
            height: 100%;
            background: linear-gradient(90deg, #ff8a00, #e52e71);
            width: 0%;
            transition: width 0.3s;
            box-shadow: 0 0 10px rgba(255, 138, 0, 0.7);
        }

        .loading-text {
            font-size: 24px;
            margin-top: 20px;
            text-align: center;
            font-weight: bold;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
        }

        /* –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ */
        .main-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at center, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 999;
        }

        .game-title {
            font-size: 72px;
            background: linear-gradient(45deg, #ff8a00, #e52e71);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(255, 138, 0, 0.5);
            font-family: 'Cinzel', serif;
            letter-spacing: 3px;
        }

        .game-subtitle {
            font-size: 20px;
            color: #a9b7c6;
            margin-bottom: 50px;
            font-style: italic;
        }

        .menu-buttons {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 300px;
        }

        .menu-btn {
            padding: 18px 30px;
            font-size: 22px;
            background: linear-gradient(45deg, rgba(255, 138, 0, 0.8), rgba(229, 46, 113, 0.8));
            border: none;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            font-weight: bold;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
        }

        .menu-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(255, 138, 0, 0.3);
            background: linear-gradient(45deg, rgba(255, 138, 0, 1), rgba(229, 46, 113, 1));
        }

        .menu-btn:active {
            transform: translateY(-2px);
        }

        .credits {
            position: absolute;
            bottom: 30px;
            color: #666;
            font-size: 16px;
            text-align: center;
        }

        .creator {
            color: #ff8a00;
            font-weight: bold;
            font-size: 18px;
            margin-top: 5px;
        }

        /* –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° */
        .game-container {
            display: none;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: rgba(25, 25, 35, 0.95);
            border-radius: 20px;
            padding: 20px 30px;
            margin-bottom: 20px;
            border: 2px solid rgba(255, 138, 0, 0.3);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }

        .player-info {
            display: flex;
            gap: 30px;
        }

        .resource {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px 20px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .resource-icon {
            font-size: 24px;
        }

        .resource-value {
            font-size: 24px;
            font-weight: bold;
            color: #ffd700;
        }

        .dragon-name {
            font-size: 28px;
            color: #ff8a00;
            font-weight: bold;
        }

        .main-content {
            display: grid;
            grid-template-columns: 350px 1fr 350px;
            gap: 20px;
            min-height: 700px;
        }

        /* –ü–ê–ù–ï–õ–¨ –î–†–ê–ö–û–ù–ê */
        .dragon-panel {
            background: rgba(25, 25, 35, 0.95);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(255, 138, 0, 0.3);
        }

        .dragon-display {
            width: 250px;
            height: 250px;
            margin: 0 auto 30px;
            position: relative;
            background: radial-gradient(circle at center, rgba(255, 138, 0, 0.1), transparent 70%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dragon-icon {
            font-size: 140px;
            animation: pulse 2s infinite;
        }

        .dragon-level {
            position: absolute;
            top: -10px;
            right: -10px;
            background: linear-gradient(45deg, #ff8a00, #e52e71);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            border: 3px solid gold;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin: 25px 0;
        }

        .stat-item {
            background: rgba(0, 0, 0, 0.5);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .stat-name {
            color: #a9b7c6;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #4dffea;
        }

        /* –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ü–ê–ù–ï–õ–¨ */
        .center-panel {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .action-panel {
            background: rgba(25, 25, 35, 0.95);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(255, 138, 0, 0.3);
            flex: 1;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .action-btn {
            padding: 20px;
            font-size: 18px;
            background: linear-gradient(45deg, rgba(40, 40, 60, 0.9), rgba(30, 30, 50, 0.9));
            border: 2px solid rgba(255, 138, 0, 0.5);
            border-radius: 15px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .action-btn:hover {
            transform: translateY(-3px);
            border-color: #ff8a00;
            box-shadow: 0 5px 15px rgba(255, 138, 0, 0.3);
            background: linear-gradient(45deg, rgba(255, 138, 0, 0.2), rgba(229, 46, 113, 0.2));
        }

        .btn-icon {
            font-size: 32px;
        }

        .battle-log {
            background: rgba(25, 25, 35, 0.95);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(229, 46, 113, 0.3);
            height: 300px;
            overflow-y: auto;
        }

        .log-entry {
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-left: 4px solid;
            animation: slideIn 0.3s ease-out;
        }

        .log-loot { border-left-color: #ffd700; background: rgba(255, 215, 0, 0.1); }
        .log-damage { border-left-color: #ff4757; background: rgba(255, 71, 87, 0.1); }
        .log-heal { border-left-color: #2ed573; background: rgba(46, 213, 115, 0.1); }
        .log-info { border-left-color: #3742fa; background: rgba(55, 66, 250, 0.1); }
        .log-quest { border-left-color: #ffa502; background: rgba(255, 165, 2, 0.1); }

        /* –ü–ê–ù–ï–õ–¨ –ò–ù–í–ï–ù–¢–ê–†–Ø */
        .inventory-panel {
            background: rgba(25, 25, 35, 0.95);
            border-radius: 20px;
            padding: 25px;
            border: 2px solid rgba(0, 184, 148, 0.3);
        }

        .inventory-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .inventory-tab {
            flex: 1;
            padding: 12px;
            background: rgba(0, 0, 0, 0.5);
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .inventory-tab.active {
            background: linear-gradient(45deg, rgba(0, 184, 148, 0.8), rgba(9, 132, 227, 0.8));
        }

        .inventory-content {
            height: 500px;
            overflow-y: auto;
        }

        .item-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
        }

        .item-slot {
            aspect-ratio: 1;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            padding: 10px;
            position: relative;
        }

        .item-slot:hover {
            border-color: #ff8a00;
            transform: scale(1.05);
        }

        .item-rarity-common { border-color: #a9b7c6; }
        .item-rarity-uncommon { border-color: #2ed573; }
        .item-rarity-rare { border-color: #3742fa; }
        .item-rarity-epic { border-color: #9b59b6; }
        .item-rarity-legendary { border-color: #f1c40f; border-width: 3px; }
        .item-rarity-mythical { border-color: #e74c3c; border-width: 3px; border-style: dashed; }

        .item-icon {
            font-size: 32px;
            margin-bottom: 5px;
        }

        .item-name {
            font-size: 12px;
            text-align: center;
            color: white;
        }

        .item-count {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 12px;
        }

        /* –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal {
            background: linear-gradient(45deg, #1a1a2e, #16213e);
            border-radius: 25px;
            padding: 30px;
            min-width: 500px;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            border: 3px solid rgba(255, 138, 0, 0.5);
            box-shadow: 0 0 50px rgba(255, 138, 0, 0.3);
            animation: modalAppear 0.3s ease-out;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 138, 0, 0.3);
        }

        .modal-title {
            font-size: 28px;
            color: #ff8a00;
            font-weight: bold;
        }

        .close-modal {
            background: none;
            border: none;
            color: white;
            font-size: 28px;
            cursor: pointer;
            transition: color 0.3s;
        }

        .close-modal:hover {
            color: #ff4757;
        }

        /* –ö–ê–†–¢–ê –°–£–ù–î–£–ö–û–í */
        .chest-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .chest {
            background: linear-gradient(45deg, rgba(30, 30, 46, 0.9), rgba(20, 20, 36, 0.9));
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 3px solid;
            position: relative;
            overflow: hidden;
        }

        .chest:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }

        .chest::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transform: rotate(45deg);
            transition: all 0.5s;
        }

        .chest:hover::before {
            left: 100%;
        }

        .chest-common { border-color: #a9b7c6; }
        .chest-uncommon { border-color: #2ed573; }
        .chest-rare { border-color: #3742fa; }
        .chest-epic { border-color: #9b59b6; }
        .chest-legendary { border-color: #f1c40f; }
        .chest-mythical { border-color: #e74c3c; }

        .chest-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }

        .chest-cost {
            margin-top: 15px;
            padding: 10px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 10px;
            font-weight: bold;
        }

        /* –°–ò–°–¢–ï–ú–ê –ó–ê–î–ê–ù–ò–ô */
        .quest-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .quest-item {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 15px;
            border-left: 5px solid #ffa502;
        }

        .quest-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .quest-name {
            font-size: 18px;
            color: white;
            font-weight: bold;
        }

        .quest-reward {
            background: linear-gradient(45deg, #ffd700, #ff8a00);
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
        }

        .quest-progress {
            height: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
            margin: 10px 0;
            overflow: hidden;
        }

        .quest-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00b894, #00cec9);
            border-radius: 5px;
            transition: width 0.3s;
        }

        /* –¢–ï–•–ù–û–õ–û–ì–ò–ò */
        .tech-tree {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
        }

        .tech-node {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid rgba(255, 255, 255, 0.1);
            position: relative;
        }

        .tech-node.unlocked {
            border-color: #2ed573;
            background: rgba(46, 213, 115, 0.1);
        }

        .tech-node.locked {
            opacity: 0.5;
            filter: grayscale(1);
        }

        .tech-node:hover:not(.locked) {
            transform: scale(1.05);
            border-color: #ff8a00;
        }

        .tech-cost {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(0, 0, 0, 0.8);
            color: #ffd700;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 12px;
        }

        /* –ë–û–°–°–´ */
        .boss-arena {
            background: rgba(229, 46, 113, 0.1);
            border: 3px solid #e52e71;
            border-radius: 20px;
            padding: 30px;
            margin-top: 20px;
        }

        .boss-info {
            display: flex;
            align-items: center;
            gap: 30px;
            margin-bottom: 25px;
        }

        .boss-icon {
            font-size: 80px;
            animation: bossPulse 2s infinite;
        }

        .boss-stats {
            flex: 1;
        }

        .boss-health {
            height: 30px;
            background: rgba(255, 71, 87, 0.2);
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
        }

        .boss-health-bar {
            height: 100%;
            background: linear-gradient(90deg, #ff4757, #ff6b81);
            border-radius: 15px;
            transition: width 0.5s;
        }

        /* –ê–ù–ò–ú–ê–¶–ò–ò */
        @keyframes dragonFloat {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(5deg); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes modalAppear {
            from { opacity: 0; transform: scale(0.8); }
            to { opacity: 1; transform: scale(1); }
        }

        @keyframes bossPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes shine {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        /* –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –°–¢–ò–õ–ò */
        .section-title {
            font-size: 24px;
            color: #ff8a00;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid rgba(255, 138, 0, 0.3);
        }

        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid #ff8a00;
            border-radius: 10px;
            padding: 15px;
            z-index: 1000;
            max-width: 300px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
        }

        .tooltip-title {
            color: #ff8a00;
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 16px;
        }

        .tooltip-description {
            color: #a9b7c6;
            font-size: 14px;
            line-height: 1.4;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(45deg, #2ed573, #1dd1a1);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 9999;
            animation: slideIn 0.3s ease-out;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .achievement-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(45deg, #ffd700, #ff8a00);
            padding: 30px;
            border-radius: 20px;
            z-index: 9999;
            text-align: center;
            animation: modalAppear 0.5s ease-out;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.5);
        }

        .achievement-icon {
            font-size: 60px;
            margin-bottom: 15px;
        }

        /* –ë–û–ï–í–ê–Ø –°–ò–°–¢–ï–ú–ê */
        .battle-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, #0f0c29, #302b63);
            z-index: 2000;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .battle-hud {
            display: flex;
            justify-content: space-between;
            width: 90%;
            max-width: 1200px;
            margin-bottom: 50px;
        }

        .combatant {
            background: rgba(0, 0, 0, 0.7);
            padding: 25px;
            border-radius: 20px;
            width: 350px;
            text-align: center;
            border: 3px solid;
        }

        .player-hud { border-color: #00b894; }
        .enemy-hud { border-color: #ff4757; }

        .health-bar-container {
            height: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            overflow: hidden;
            margin: 20px 0;
        }

        .health-bar {
            height: 100%;
            border-radius: 15px;
            transition: width 0.5s;
        }

        .player-health { background: linear-gradient(90deg, #00b894, #00cec9); }
        .enemy-health { background: linear-gradient(90deg, #ff4757, #ff6b81); }

        .battle-actions {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            width: 90%;
            max-width: 1200px;
        }

        .battle-action {
            padding: 20px;
            font-size: 18px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #3742fa;
            border-radius: 15px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .battle-action:hover:not(:disabled) {
            background: rgba(55, 66, 250, 0.3);
            transform: translateY(-5px);
        }

        .battle-action:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .battle-log-container {
            width: 90%;
            max-width: 1200px;
            height: 200px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 15px;
            padding: 20px;
            margin-top: 30px;
            overflow-y: auto;
            border: 2px solid #ffa502;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- –≠–ö–†–ê–ù –ó–ê–ì–†–£–ó–ö–ò -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-dragon">üêâ</div>
        <div class="loading-bar">
            <div class="loading-progress" id="loadingProgress"></div>
        </div>
        <div class="loading-text" id="loadingText">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —è–¥—Ä–∞ –¥—Ä–∞–∫–æ–Ω–∞...</div>
    </div>

    <!-- –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ -->
    <div class="main-menu" id="mainMenu">
        <div class="game-title">DRAGON EVOLUTION</div>
        <div class="game-subtitle">Legacy of Agafonov</div>
        <div class="menu-buttons">
            <button class="menu-btn" onclick="startGame()">
                <i class="fas fa-play"></i> –ù–æ–≤–∞—è –∏–≥—Ä–∞
            </button>
            <button class="menu-btn" onclick="loadGame()">
                <i class="fas fa-folder-open"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å –∏–≥—Ä—É
            </button>
            <button class="menu-btn" onclick="showSettings()">
                <i class="fas fa-cog"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∏
            </button>
            <button class="menu-btn" onclick="showAchievements()">
                <i class="fas fa-trophy"></i> –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            </button>
            <button class="menu-btn" onclick="showHowToPlay()">
                <i class="fas fa-question-circle"></i> –û–±—É—á–µ–Ω–∏–µ
            </button>
        </div>
        <div class="credits">
            –í–æ–ø–ª–æ—â–µ–Ω–∏–µ –ª–µ–≥–µ–Ω–¥—ã –≤ –∫–æ–¥–µ<br>
            <div class="creator">–û—Å–Ω–æ–≤–∞—Ç–µ–ª—å: AGAFONOV</div>
            –í–µ—Ä—Å–∏—è 2.0 | Dragon Engine
        </div>
    </div>

    <!-- –û–°–ù–û–í–ù–û–ô –ò–ù–¢–ï–†–§–ï–ô–° -->
    <div class="game-container" id="gameContainer">
        <div class="header">
            <div class="dragon-name" id="dragonName">–î—Ä–∞–∫–æ–Ω –ê–≥–∞—Ñ–æ–Ω–æ–≤–∞</div>
            <div class="player-info">
                <div class="resource">
                    <div class="resource-icon">üíé</div>
                    <div class="resource-value" id="gold">1000</div>
                </div>
                <div class="resource">
                    <div class="resource-icon">‚ú®</div>
                    <div class="resource-value" id="essence">500</div>
                </div>
                <div class="resource">
                    <div class="resource-icon">üîÆ</div>
                    <div class="resource-value" id="crystals">50</div>
                </div>
                <div class="resource">
                    <div class="resource-icon">‚ö°</div>
                    <div class="resource-value" id="energy">100</div>
                </div>
            </div>
        </div>

        <div class="main-content">
            <!-- –õ–ï–í–ê–Ø –ü–ê–ù–ï–õ–¨: –î–†–ê–ö–û–ù -->
            <div class="dragon-panel">
                <div class="dragon-display">
                    <div class="dragon-icon" id="dragonIcon">üêâ</div>
                    <div class="dragon-level" id="dragonLevel">1</div>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-name">–ê—Ç–∞–∫–∞</div>
                        <div class="stat-value" id="statAttack">150</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">–ó–∞—â–∏—Ç–∞</div>
                        <div class="stat-value" id="statDefense">75</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">–ó–¥–æ—Ä–æ–≤—å–µ</div>
                        <div class="stat-value" id="statHealth">1000/1000</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">–°–∫–æ—Ä–æ—Å—Ç—å</div>
                        <div class="stat-value" id="statSpeed">120</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">–ö—Ä–∏—Ç. —É–¥–∞—Ä</div>
                        <div class="stat-value" id="statCrit">15%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-name">–£–∫–ª–æ–Ω–µ–Ω–∏–µ</div>
                        <div class="stat-value" id="statDodge">10%</div>
                    </div>
                </div>

                <div class="section-title">–≠–∫–∏–ø–∏—Ä–æ–≤–∫–∞</div>
                <div class="equipment-slots">
                    <div class="stats-grid">
                        <div class="stat-item equipment-slot" data-slot="head">
                            <div class="stat-name">–®–ª–µ–º</div>
                            <div class="stat-value" id="equipHead">-</div>
                        </div>
                        <div class="stat-item equipment-slot" data-slot="chest">
                            <div class="stat-name">–ù–∞–≥—Ä—É–¥–Ω–∏–∫</div>
                            <div class="stat-value" id="equipChest">-</div>
                        </div>
                        <div class="stat-item equipment-slot" data-slot="legs">
                            <div class="stat-name">–ü–æ–Ω–æ–∂–∏</div>
                            <div class="stat-value" id="equipLegs">-</div>
                        </div>
                        <div class="stat-item equipment-slot" data-slot="weapon">
                            <div class="stat-name">–û—Ä—É–∂–∏–µ</div>
                            <div class="stat-value" id="equipWeapon">-</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –¶–ï–ù–¢–†–ê–õ–¨–ù–ê–Ø –ü–ê–ù–ï–õ–¨ -->
            <div class="center-panel">
                <div class="action-panel">
                    <div class="section-title">–î–µ–π—Å—Ç–≤–∏—è</div>
                    <div class="action-buttons">
                        <button class="action-btn" onclick="startHunt()">
                            <div class="btn-icon">üèπ</div>
                            <div>–û—Ö–æ—Ç–∞</div>
                        </button>
                        <button class="action-btn" onclick="showChests()">
                            <div class="btn-icon">üéÅ</div>
                            <div>–°—É–Ω–¥—É–∫–∏</div>
                        </button>
                        <button class="action-btn" onclick="showDungeon()">
                            <div class="btn-icon">üè∞</div>
                            <div>–ü–æ–¥–∑–µ–º–µ–ª—å–µ</div>
                        </button>
                        <button class="action-btn" onclick="startTraining()">
                            <div class="btn-icon">üí™</div>
                            <div>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞</div>
                        </button>
                        <button class="action-btn" onclick="showEnchant()">
                            <div class="btn-icon">üîÆ</div>
                            <div>–ó–∞—á–∞—Ä–æ–≤–∞—Ç—å</div>
                        </button>
                        <button class="action-btn" onclick="showEvolution()">
                            <div class="btn-icon">üî•</div>
                            <div>–≠–≤–æ–ª—é—Ü–∏—è</div>
                        </button>
                        <button class="action-btn" onclick="showQuests()">
                            <div class="btn-icon">üìú</div>
                            <div>–ó–∞–¥–∞–Ω–∏—è</div>
                        </button>
                        <button class="action-btn" onclick="showBosses()">
                            <div class="btn-icon">üëπ</div>
                            <div>–ë–æ—Å—Å—ã</div>
                        </button>
                        <button class="action-btn" onclick="showClan()">
                            <div class="btn-icon">üèõÔ∏è</div>
                            <div>–ö–ª–∞–Ω</div>
                        </button>
                    </div>
                </div>

                <div class="battle-log" id="battleLog">
                    <div class="log-entry log-info">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä –¥—Ä–∞–∫–æ–Ω–æ–≤!</div>
                    <div class="log-entry log-info">–ù–∞—á–∏–Ω–∞–π—Ç–µ –æ—Ö–æ—Ç—É, —Å–æ–±–∏—Ä–∞–π—Ç–µ –¥–æ—Å–ø–µ—Ö–∏ –∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å —Å–∏–ª—å–Ω–µ–µ!</div>
                </div>
            </div>

            <!-- –ü–†–ê–í–ê–Ø –ü–ê–ù–ï–õ–¨: –ò–ù–í–ï–ù–¢–ê–†–¨ -->
            <div class="inventory-panel">
                <div class="section-title">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
                <div class="inventory-tabs">
                    <button class="inventory-tab active" onclick="switchTab('armor')">–î–æ—Å–ø–µ—Ö–∏</button>
                    <button class="inventory-tab" onclick="switchTab('weapons')">–û—Ä—É–∂–∏–µ</button>
                    <button class="inventory-tab" onclick="switchTab('potions')">–ó–µ–ª—å—è</button>
                    <button class="inventory-tab" onclick="switchTab('materials')">–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</button>
                </div>
                <div class="inventory-content" id="inventoryContent">
                    <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>
        </div>
    </div>

    <!-- –ë–û–ï–í–ê–Ø –°–ò–°–¢–ï–ú–ê -->
    <div class="battle-container" id="battleContainer">
        <div class="battle-hud">
            <div class="combatant player-hud">
                <div class="combatant-name" id="battlePlayerName">–í–∞—à –î—Ä–∞–∫–æ–Ω</div>
                <div class="health-bar-container">
                    <div class="health-bar player-health" id="playerHealthBar" style="width: 100%"></div>
                </div>
                <div class="combatant-stats" id="playerBattleStats"></div>
            </div>
            <div class="combatant enemy-hud">
                <div class="combatant-name" id="battleEnemyName">–ü—Ä–æ—Ç–∏–≤–Ω–∏–∫</div>
                <div class="health-bar-container">
                    <div class="health-bar enemy-health" id="enemyHealthBar" style="width: 100%"></div>
                </div>
                <div class="combatant-stats" id="enemyBattleStats"></div>
            </div>
        </div>
        
        <div class="battle-log-container" id="battleLogContainer"></div>
        
        <div class="battle-actions" id="battleActions">
            <!-- –ë–æ–µ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –±—É–¥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
    </div>

    <!-- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê -->
    <div class="modal-overlay" id="modalOverlay">
        <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –±—É–¥—É—Ç –≤—Å—Ç–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
    </div>

    <!-- –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø -->
    <div class="notification" id="notification" style="display: none;"></div>
    <div class="achievement-popup" id="achievementPopup" style="display: none;"></div>

    <script>
        // ==================== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ====================
        let gameState = {
            version: "2.0",
            dragonName: "–î—Ä–∞–∫–æ–Ω –ê–≥–∞—Ñ–æ–Ω–æ–≤–∞",
            level: 1,
            xp: 0,
            xpToNextLevel: 100,
            gold: 1000,
            essence: 500,
            crystals: 50,
            energy: 100,
            maxEnergy: 100,
            energyRegenTime: Date.now(),
            
            stats: {
                attack: 150,
                defense: 75,
                health: 1000,
                maxHealth: 1000,
                speed: 120,
                critical: 15,
                dodge: 10,
                armor: 0,
                fireDamage: 50,
                iceResist: 20,
                poisonResist: 20,
                lightningResist: 20
            },
            
            equipment: {
                head: null,
                chest: null,
                legs: null,
                weapon: null,
                wings: null,
                amulet: null,
                ring1: null,
                ring2: null
            },
            
            inventory: {
                armor: [],
                weapons: [],
                potions: [],
                materials: []
            },
            
            enchants: [],
            activeQuests: [],
            completedQuests: [],
            achievements: [],
            unlockedTechnologies: [],
            clanLevel: 0,
            dungeonProgress: 0,
            bossKills: {},
            gameTime: 0,
            
            // –°–∏—Å—Ç–µ–º–∞ —Ä–µ–º–µ—Å–ª–∞
            craftingRecipes: [],
            discoveredRecipes: [],
            
            // –°–∏—Å—Ç–µ–º–∞ –Ω–∞–≤—ã–∫–æ–≤
            skills: {
                fireBreath: 1,
                iceBreath: 0,
                poisonBreath: 0,
                healingFlames: 0,
                dragonRage: 0
            },
            
            skillPoints: 0
        };

        const ITEM_DATABASE = {
            // –®–õ–ï–ú–´
            head: [
                { id: "helmet_1", name: "–®–ª–µ–º –Ω–æ–≤–∏—á–∫–∞", rarity: "common", icon: "üëë", 
                  stats: { defense: 10, health: 50 }, price: 100, level: 1 },
                { id: "helmet_2", name: "–ö–∞–ø—é—à–æ–Ω –æ—Ö–æ—Ç–Ω–∏–∫–∞", rarity: "uncommon", icon: "üé©", 
                  stats: { defense: 20, health: 100, dodge: 5 }, price: 250, level: 3 },
                { id: "helmet_3", name: "–ö–æ—Ä–æ–Ω–∞ –¥—Ä–∞–∫–æ–Ω–∞", rarity: "rare", icon: "üëë", 
                  stats: { defense: 35, health: 200, critical: 10 }, price: 500, level: 5 },
                { id: "helmet_4", name: "–®–ª–µ–º —Ç–∏—Ç–∞–Ω–∞", rarity: "epic", icon: "‚õëÔ∏è", 
                  stats: { defense: 60, health: 400, armor: 15 }, price: 1000, level: 10 },
                { id: "helmet_5", name: "–í–µ–Ω–µ—Ü —Ñ–µ–Ω–∏–∫—Å–∞", rarity: "legendary", icon: "üî•", 
                  stats: { defense: 100, health: 800, fireDamage: 50, critical: 20 }, price: 2500, level: 20 }
            ],
            
            // –ù–ê–ì–†–£–î–ù–ò–ö–ò
            chest: [
                { id: "chest_1", name: "–ö–∏—Ä–∞—Å–∞ —É—á–µ–Ω–∏–∫–∞", rarity: "common", icon: "üëï", 
                  stats: { defense: 20, health: 100 }, price: 150, level: 1 },
                { id: "chest_2", name: "–î–æ—Å–ø–µ—Ö –≤–æ–∏–Ω–∞", rarity: "uncommon", icon: "ü¶∫", 
                  stats: { defense: 40, health: 200, armor: 5 }, price: 350, level: 3 },
                { id: "chest_3", name: "–ë—Ä–æ–Ω—è –¥—Ä–∞–∫–æ–Ω–∞", rarity: "rare", icon: "üêâ", 
                  stats: { defense: 70, health: 400, fireResist: 30 }, price: 700, level: 5 },
                { id: "chest_4", name: "–ù–∞–≥—Ä—É–¥–Ω–∏–∫ –ª–µ–≤–∏–∞—Ñ–∞–Ω–∞", rarity: "epic", icon: "üåä", 
                  stats: { defense: 120, health: 800, iceResist: 50 }, price: 1500, level: 10 },
                { id: "chest_5", name: "–ü–ª–∞—â –±–æ–≥–æ–≤", rarity: "legendary", icon: "‚ú®", 
                  stats: { defense: 200, health: 1500, allResist: 25, dodge: 15 }, price: 5000, level: 25 }
            ],
            
            // –û–†–£–ñ–ò–ï
            weapons: [
                { id: "weapon_1", name: "–ö–æ–≥—Ç–∏ –Ω–æ–≤–∏—á–∫–∞", rarity: "common", icon: "‚úã", 
                  stats: { attack: 20, speed: 10 }, price: 200, level: 1 },
                { id: "weapon_2", name: "–ö–ª—ã–∫–∏ –æ—Ö–æ—Ç–Ω–∏–∫–∞", rarity: "uncommon", icon: "ü¶∑", 
                  stats: { attack: 40, critical: 10 }, price: 450, level: 3 },
                { id: "weapon_3", name: "–ü–ª–∞–º–µ–Ω–Ω—ã–µ –∫–æ–≥—Ç–∏", rarity: "rare", icon: "üî•", 
                  stats: { attack: 80, fireDamage: 30, speed: 15 }, price: 900, level: 5 },
                { id: "weapon_4", name: "–ú–æ–ª–æ—Ç —Ç–∏—Ç–∞–Ω–∞", rarity: "epic", icon: "üî®", 
                  stats: { attack: 150, critical: 20, armorPen: 30 }, price: 2000, level: 10 },
                { id: "weapon_5", name: "–ö–ª–∏–Ω–æ–∫ –∞–ø–æ–∫–∞–ª–∏–ø—Å–∏—Å–∞", rarity: "legendary", icon: "‚öîÔ∏è", 
                  stats: { attack: 300, critical: 30, allDamage: 50 }, price: 7500, level: 30 }
            ],
            
            // –ó–ï–õ–¨–Ø
            potions: [
                { id: "potion_1", name: "–ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è I", rarity: "common", icon: "‚ù§Ô∏è", 
                  effect: { health: 200 }, price: 50, stackable: true },
                { id: "potion_2", name: "–ó–µ–ª—å–µ –∞—Ç–∞–∫–∏ I", rarity: "uncommon", icon: "‚öîÔ∏è", 
                  effect: { attack: 30, duration: 300 }, price: 100, stackable: true },
                { id: "potion_3", name: "–ó–µ–ª—å–µ –∑–∞—â–∏—Ç—ã I", rarity: "uncommon", icon: "üõ°Ô∏è", 
                  effect: { defense: 20, duration: 300 }, price: 100, stackable: true },
                { id: "potion_4", name: "–ó–µ–ª—å–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ I", rarity: "rare", icon: "‚ö°", 
                  effect: { speed: 50, duration: 180 }, price: 200, stackable: true },
                { id: "potion_5", name: "–≠–ª–∏–∫—Å–∏—Ä –¥—Ä–∞–∫–æ–Ω–∞", rarity: "epic", icon: "üêâ", 
                  effect: { allStats: 20, duration: 600 }, price: 500, stackable: true }
            ],
            
            // –ú–ê–¢–ï–†–ò–ê–õ–´ –î–õ–Ø –ö–†–ê–§–¢–ê
            materials: [
                { id: "mat_1", name: "–î—Ä–∞–∫–æ–Ω—å—è —á–µ—à—É—è", rarity: "common", icon: "üî∏", price: 10 },
                { id: "mat_2", name: "–û–≥–Ω–µ–Ω–Ω—ã–π –∫—Ä–∏—Å—Ç–∞–ª–ª", rarity: "uncommon", icon: "üî¥", price: 25 },
                { id: "mat_3", name: "–õ–µ–¥—è–Ω–æ–µ —Å–µ—Ä–¥—Ü–µ", rarity: "rare", icon: "‚ùÑÔ∏è", price: 50 },
                { id: "mat_4", name: "–Ø–¥—Ä–æ –¥—Ä–∞–∫–æ–Ω–∞", rarity: "epic", icon: "üíé", price: 100 },
                { id: "mat_5", name: "–î—É—à–∞ —Ç–∏—Ç–∞–Ω–∞", rarity: "legendary", icon: "üëª", price: 500 }
            ]
        };

        const CHEST_TYPES = [
            {
                id: "chest_common",
                name: "–û–±—ã—á–Ω—ã–π —Å—É–Ω–¥—É–∫",
                icon: "üéÅ",
                rarity: "common",
                cost: 100,
                rewards: {
                    gold: [50, 150],
                    items: { common: 80, uncommon: 20 }
                }
            },
            {
                id: "chest_uncommon",
                name: "–ù–µ–æ–±—ã—á–Ω—ã–π —Å—É–Ω–¥—É–∫",
                icon: "üéÅ",
                rarity: "uncommon",
                cost: 250,
                rewards: {
                    gold: [150, 300],
                    essence: [10, 30],
                    items: { common: 50, uncommon: 40, rare: 10 }
                }
            },
            {
                id: "chest_rare",
                name: "–†–µ–¥–∫–∏–π —Å—É–Ω–¥—É–∫",
                icon: "üíé",
                rarity: "rare",
                cost: 500,
                rewards: {
                    gold: [300, 600],
                    essence: [30, 60],
                    crystals: [1, 3],
                    items: { uncommon: 50, rare: 40, epic: 10 }
                }
            },
            {
                id: "chest_epic",
                name: "–≠–ø–∏—á–µ—Å–∫–∏–π —Å—É–Ω–¥—É–∫",
                icon: "üèÜ",
                rarity: "epic",
                cost: 1000,
                rewards: {
                    gold: [600, 1200],
                    essence: [60, 120],
                    crystals: [3, 6],
                    items: { rare: 50, epic: 40, legendary: 10 }
                }
            },
            {
                id: "chest_legendary",
                name: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π —Å—É–Ω–¥—É–∫",
                icon: "üëë",
                rarity: "legendary",
                cost: 2500,
                rewards: {
                    gold: [1200, 2500],
                    essence: [120, 240],
                    crystals: [6, 12],
                    items: { epic: 60, legendary: 35, mythical: 5 }
                }
            }
        ];

        const QUESTS = [
            {
                id: "quest_1",
                name: "–ü–µ—Ä–≤–∞—è –æ—Ö–æ—Ç–∞",
                description: "–í—ã–ø–æ–ª–Ω–∏—Ç–µ 5 –æ—Ö–æ—Ç",
                type: "hunt",
                required: 5,
                rewards: { gold: 500, xp: 100, item: "helmet_1" },
                repeatable: false
            },
            {
                id: "quest_2",
                name: "–°–æ–±–∏—Ä–∞—Ç–µ–ª—å —Å–æ–∫—Ä–æ–≤–∏—â",
                description: "–û—Ç–∫—Ä–æ–π—Ç–µ 3 —Å—É–Ω–¥—É–∫–∞",
                type: "chest",
                required: 3,
                rewards: { gold: 750, essence: 50, item: "chest_1" },
                repeatable: false
            },
            {
                id: "quest_3",
                name: "–£–±–∏–π—Ü–∞ –¥—Ä–∞–∫–æ–Ω–æ–≤",
                description: "–ü–æ–±–µ–¥–∏—Ç–µ 10 –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–æ–≤ –≤ –±–∏—Ç–≤–∞—Ö",
                type: "battle",
                required: 10,
                rewards: { gold: 1000, xp: 250, crystals: 5 },
                repeatable: true
            }
        ];

        const ENEMIES = [
            {
                id: "enemy_1",
                name: "–ú–æ–ª–æ–¥–æ–π –¥—Ä–∞–∫–æ–Ω",
                level: 1,
                health: 300,
                attack: 40,
                defense: 20,
                speed: 80,
                rewards: { xp: 50, gold: 100 }
            },
            {
                id: "enemy_2",
                name: "–û–≥–Ω–µ–Ω–Ω—ã–π —è—â–µ—Ä",
                level: 3,
                health: 600,
                attack: 80,
                defense: 40,
                speed: 100,
                rewards: { xp: 100, gold: 200, essence: 10 }
            },
            {
                id: "enemy_3",
                name: "–õ–µ–¥—è–Ω–æ–π –¥—Ä–∞–∫–æ–Ω",
                level: 5,
                health: 1000,
                attack: 120,
                defense: 60,
                speed: 120,
                rewards: { xp: 200, gold: 400, crystals: 2 }
            },
            {
                id: "enemy_4",
                name: "–ì—Ä–æ–∑–æ–≤–æ–π –¥—Ä–∞–∫–æ–Ω",
                level: 10,
                health: 2000,
                attack: 200,
                defense: 100,
                speed: 150,
                rewards: { xp: 500, gold: 1000, essence: 50 }
            }
        ];

        // ==================== –°–ò–°–¢–ï–ú–ê –ó–ê–ì–†–£–ó–ö–ò ====================
        const loadingPhases = [
            "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —è–¥—Ä–∞ –¥—Ä–∞–∫–æ–Ω–∞...",
            "–ó–∞–≥—Ä—É–∑–∫–∞ —Ç–µ–∫—Å—Ç—É—Ä –∏ –∞–Ω–∏–º–∞—Ü–∏–π...",
            "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∏—Ä–∞ –¥—Ä–∞–∫–æ–Ω–æ–≤...",
            "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º –±–æ—è...",
            "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è...",
            "–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–≤–µ—Å—Ç–æ–≤...",
            "–ê–∫—Ç–∏–≤–∞—Ü–∏—è –º–∞–≥–∏–∏...",
            "–ó–∞–ø—É—Å–∫ –∏–≥—Ä–æ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞..."
        ];

        function simulateLoading() {
            let progress = 0;
            const progressBar = document.getElementById('loadingProgress');
            const loadingText = document.getElementById('loadingText');
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    
                    // –ü–µ—Ä–µ—Ö–æ–¥ –∫ –≥–ª–∞–≤–Ω–æ–º—É –º–µ–Ω—é
                    setTimeout(() => {
                        document.getElementById('loadingScreen').style.opacity = '0';
                        setTimeout(() => {
                            document.getElementById('loadingScreen').style.display = 'none';
                            document.getElementById('mainMenu').style.display = 'flex';
                        }, 1000);
                    }, 500);
                }
                
                progressBar.style.width = progress + '%';
                
                // –ú–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç –∫–∞–∂–¥—ã–µ 12.5%
                if (progress % 12.5 < 1) {
                    const phaseIndex = Math.min(Math.floor(progress / 12.5), loadingPhases.length - 1);
                    loadingText.textContent = loadingPhases[phaseIndex];
                }
            }, 200);
        }

        // ==================== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò–ì–†–´ ====================
        function startGame() {
            // –°–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–≥—Ä—É
            document.getElementById('mainMenu').style.display = 'none';
            document.getElementById('gameContainer').style.display = 'block';
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            initializeGameData();
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
            startGameLoop();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            addLog("üöÄ –ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –£–¥–∞—á–∏ –≤ —Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –≤–µ–ª–∏—á–∞–π—à–∏–º –¥—Ä–∞–∫–æ–Ω–æ–º!", "info");
            showNotification("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä –¥—Ä–∞–∫–æ–Ω–æ–≤!");
        }

        function initializeGameData() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–π –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
            gameState.inventory.armor = [
                { ...ITEM_DATABASE.head[0], count: 1 },
                { ...ITEM_DATABASE.chest[0], count: 1 }
            ];
            
            gameState.inventory.weapons = [
                { ...ITEM_DATABASE.weapons[0], count: 1 }
            ];
            
            gameState.inventory.potions = [
                { ...ITEM_DATABASE.potions[0], count: 3 }
            ];
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–≤–µ—Å—Ç—ã
            gameState.activeQuests = QUESTS.slice(0, 2).map(q => ({
                ...q,
                progress: 0,
                completed: false
            }));
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            gameState.achievements = [
                { id: "first_steps", name: "–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏", description: "–ù–∞—á–Ω–∏—Ç–µ –∏–≥—Ä—É", earned: true, reward: 100 },
                { id: "first_hunt", name: "–ü–µ—Ä–≤—ã–π –æ—Ö–æ—Ç–Ω–∏–∫", description: "–í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–≤—É—é –æ—Ö–æ—Ç—É", earned: false, reward: 250 }
            ];
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateUI();
            updateInventory();
        }

        // ==================== –û–°–ù–û–í–ù–û–ô –ò–ì–†–û–í–û–ô –¶–ò–ö–õ ====================
        function startGameLoop() {
            // –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
            setInterval(() => {
                updateGameState();
            }, 1000);
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —ç–Ω–µ—Ä–≥–∏–∏
            setInterval(() => {
                regenEnergy();
            }, 30000); // –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º —Ü–∏–∫–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            setInterval(() => {
                autoSave();
            }, 60000); // –ö–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
        }

        function updateGameState() {
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –∏–≥—Ä—ã
            gameState.gameTime++;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—é —ç–Ω–µ—Ä–≥–∏–∏
            if (Date.now() - gameState.energyRegenTime > 30000) {
                regenEnergy();
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–≤–µ—Å—Ç–æ–≤
            updateQuests();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUI();
        }

        function regenEnergy() {
            if (gameState.energy < gameState.maxEnergy) {
                const regenAmount = Math.floor(gameState.maxEnergy * 0.1); // 10% –æ—Ç –º–∞–∫—Å–∏–º—É–º–∞
                gameState.energy = Math.min(gameState.maxEnergy, gameState.energy + regenAmount);
                gameState.energyRegenTime = Date.now();
                updateUI();
            }
        }

        // ==================== –°–ò–°–¢–ï–ú–ê –û–•–û–¢–´ ====================
        function startHunt() {
            if (gameState.energy < 10) {
                showNotification("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏ –¥–ª—è –æ—Ö–æ—Ç—ã!");
                return;
            }
            
            gameState.energy -= 10;
            
            // –®–∞–Ω—Å –Ω–∞ —Ä–∞–∑–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏ –æ—Ö–æ—Ç–µ
            const eventRoll = Math.random();
            
            if (eventRoll < 0.6) {
                // –£—Å–ø–µ—à–Ω–∞—è –æ—Ö–æ—Ç–∞
                const goldEarned = Math.floor(Math.random() * 100) + 50 + gameState.level * 10;
                const xpEarned = Math.floor(Math.random() * 30) + 20;
                const essenceEarned = Math.random() < 0.3 ? Math.floor(Math.random() * 10) + 5 : 0;
                
                gameState.gold += goldEarned;
                gameState.xp += xpEarned;
                gameState.essence += essenceEarned;
                
                // –®–∞–Ω—Å –Ω–∞–π—Ç–∏ –ø—Ä–µ–¥–º–µ—Ç
                if (Math.random() < 0.2) {
                    const itemType = Math.random() < 0.5 ? "armor" : "weapons";
                    const rarityRoll = Math.random();
                    let rarityIndex;
                    
                    if (rarityRoll < 0.6) rarityIndex = 0; // common
                    else if (rarityRoll < 0.85) rarityIndex = 1; // uncommon
                    else if (rarityRoll < 0.95) rarityIndex = 2; // rare
                    else if (rarityRoll < 0.99) rarityIndex = 3; // epic
                    else rarityIndex = 4; // legendary
                    
                    const item = { ...ITEM_DATABASE[itemType][rarityIndex], count: 1 };
                    gameState.inventory[itemType].push(item);
                    
                    addLog(`üèπ –û—Ö–æ—Ç–∞ —É—Å–ø–µ—à–Ω–∞! –ù–∞–π–¥–µ–Ω–æ: ${goldEarned} –∑–æ–ª–æ—Ç–∞, ${xpEarned} –æ–ø—ã—Ç–∞ –∏ ${item.name}`, "loot");
                } else {
                    addLog(`üèπ –û—Ö–æ—Ç–∞ —É—Å–ø–µ—à–Ω–∞! –ü–æ–ª—É—á–µ–Ω–æ: ${goldEarned} –∑–æ–ª–æ—Ç–∞, ${xpEarned} –æ–ø—ã—Ç–∞`, "loot");
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–≤–µ—Å—Ç–∞ –Ω–∞ –æ—Ö–æ—Ç—É
                updateQuestProgress("hunt", 1);
                
            } else if (eventRoll < 0.8) {
                // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å –≤—Ä–∞–≥–æ–º
                const enemy = ENEMIES[Math.floor(Math.random() * Math.min(gameState.level, ENEMIES.length))];
                startBattle(enemy);
                
            } else {
                // –û—Å–æ–±–æ–µ —Å–æ–±—ã—Ç–∏–µ
                const events = [
                    { text: "–í—ã –Ω–∞—à–ª–∏ –¥—Ä–µ–≤–Ω–∏–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç!", reward: { crystals: 5 }, type: "info" },
                    { text: "–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Å–∫—Ä—ã—Ç–∞—è –ø–µ—â–µ—Ä–∞ —Å —Å–æ–∫—Ä–æ–≤–∏—â–∞–º–∏!", reward: { gold: 500, essence: 50 }, type: "loot" },
                    { text: "–í—Å—Ç—Ä–µ—Ç–∏–ª–∏ –º—É–¥—Ä–æ–≥–æ –¥—Ä–∞–∫–æ–Ω–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–µ–ª–∏–ª—Å—è –∑–Ω–∞–Ω–∏—è–º–∏", reward: { xp: 100 }, type: "info" }
                ];
                
                const event = events[Math.floor(Math.random() * events.length)];
                
                // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞–≥—Ä–∞–¥—É
                Object.entries(event.reward).forEach(([key, value]) => {
                    gameState[key] += value;
                });
                
                addLog(`üèπ ${event.text}`, event.type);
            }
            
            checkLevelUp();
            updateUI();
        }

        // ==================== –ë–û–ï–í–ê–Ø –°–ò–°–¢–ï–ú–ê ====================
        let currentBattle = null;

        function startBattle(enemy) {
            currentBattle = {
                enemy: enemy,
                playerHealth: gameState.stats.health,
                enemyHealth: enemy.health,
                playerMaxHealth: gameState.stats.health,
                enemyMaxHealth: enemy.health,
                turn: "player", // player –∏–ª–∏ enemy
                round: 1
            };
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–æ–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            document.getElementById('battleContainer').style.display = 'flex';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–∏—Ç–≤–µ
            updateBattleUI();
            
            addLog(`‚öîÔ∏è –ù–∞—á–∞–ª–∞—Å—å –±–∏—Ç–≤–∞ —Å ${enemy.name}!`, "damage");
        }

        function updateBattleUI() {
            if (!currentBattle) return;
            
            const { enemy, playerHealth, enemyHealth, playerMaxHealth, enemyMaxHealth } = currentBattle;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–º–µ–Ω–∞
            document.getElementById('battlePlayerName').textContent = gameState.dragonName;
            document.getElementById('battleEnemyName').textContent = enemy.name;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–¥–æ—Ä–æ–≤—å–µ
            const playerHealthPercent = (playerHealth / playerMaxHealth) * 100;
            const enemyHealthPercent = (enemyHealth / enemyMaxHealth) * 100;
            
            document.getElementById('playerHealthBar').style.width = `${playerHealthPercent}%`;
            document.getElementById('enemyHealthBar').style.width = `${enemyHealthPercent}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            document.getElementById('playerBattleStats').innerHTML = `
                –£—Ä–æ–≤–µ–Ω—å: ${gameState.level}<br>
                –ê—Ç–∞–∫–∞: ${gameState.stats.attack}<br>
                –ó–∞—â–∏—Ç–∞: ${gameState.stats.defense}
            `;
            
            document.getElementById('enemyBattleStats').innerHTML = `
                –£—Ä–æ–≤–µ–Ω—å: ${enemy.level}<br>
                –ê—Ç–∞–∫–∞: ${enemy.attack}<br>
                –ó–∞—â–∏—Ç–∞: ${enemy.defense}
            `;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –±–æ–µ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
            updateBattleActions();
        }

        function updateBattleActions() {
            const battleActions = document.getElementById('battleActions');
            battleActions.innerHTML = '';
            
            const actions = [
                { name: "–ê—Ç–∞–∫–∞", icon: "‚öîÔ∏è", action: () => performAttack() },
                { name: "–û–≥–Ω–µ–Ω–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ", icon: "üî•", action: () => useSkill("fireBreath") },
                { name: "–ó–∞—â–∏—Ç–∞", icon: "üõ°Ô∏è", action: () => useDefense() },
                { name: "–ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è", icon: "‚ù§Ô∏è", action: () => usePotion("health") }
            ];
            
            actions.forEach(action => {
                const button = document.createElement('button');
                button.className = 'battle-action';
                button.innerHTML = `${action.icon} ${action.name}`;
                button.onclick = action.action;
                battleActions.appendChild(button);
            });
        }

        function performAttack() {
            if (!currentBattle || currentBattle.turn !== "player") return;
            
            const { enemy } = currentBattle;
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —É—Ä–æ–Ω
            let damage = gameState.stats.attack;
            const critRoll = Math.random() * 100;
            if (critRoll < gameState.stats.critical) {
                damage *= 2;
                addBattleLog(`üéØ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–¥–∞—Ä! –í—ã –Ω–∞–Ω–µ—Å–ª–∏ ${damage} —É—Ä–æ–Ω–∞!`, "damage");
            } else {
                // –£—á–∏—Ç—ã–≤–∞–µ–º –∑–∞—â–∏—Ç—É –≤—Ä–∞–≥–∞
                damage = Math.max(1, damage - enemy.defense / 2);
                addBattleLog(`‚öîÔ∏è –í—ã –Ω–∞–Ω–µ—Å–ª–∏ ${damage} —É—Ä–æ–Ω–∞.`, "damage");
            }
            
            currentBattle.enemyHealth -= damage;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–±–µ–∂–¥–µ–Ω –ª–∏ –≤—Ä–∞–≥
            if (currentBattle.enemyHealth <= 0) {
                endBattle(true);
                return;
            }
            
            // –ü–µ—Ä–µ—Ö–æ–¥ —Ö–æ–¥–∞ –∫ –≤—Ä–∞–≥—É
            currentBattle.turn = "enemy";
            setTimeout(enemyTurn, 1000);
            
            updateBattleUI();
        }

        function enemyTurn() {
            if (!currentBattle || currentBattle.turn !== "enemy") return;
            
            const { enemy } = currentBattle;
            
            // –í—Ä–∞–≥ –∞—Ç–∞–∫—É–µ—Ç
            let damage = enemy.attack;
            // –£—á–∏—Ç—ã–≤–∞–µ–º –∑–∞—â–∏—Ç—É –∏–≥—Ä–æ–∫–∞
            damage = Math.max(1, damage - gameState.stats.defense / 2);
            
            currentBattle.playerHealth -= damage;
            
            addBattleLog(`${enemy.name} –Ω–∞–Ω–æ—Å–∏—Ç ${damage} —É—Ä–æ–Ω–∞.`, "damage");
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–±–µ–∂–¥–µ–Ω –ª–∏ –∏–≥—Ä–æ–∫
            if (currentBattle.playerHealth <= 0) {
                endBattle(false);
                return;
            }
            
            // –ü–µ—Ä–µ—Ö–æ–¥ —Ö–æ–¥–∞ –∫ –∏–≥—Ä–æ–∫—É
            currentBattle.turn = "player";
            currentBattle.round++;
            
            updateBattleUI();
        }

        function endBattle(playerWon) {
            const { enemy } = currentBattle;
            
            if (playerWon) {
                // –ù–∞–≥—Ä–∞–¥–∞ –∑–∞ –ø–æ–±–µ–¥—É
                gameState.gold += enemy.rewards.gold;
                gameState.xp += enemy.rewards.xp;
                if (enemy.rewards.essence) gameState.essence += enemy.rewards.essence;
                if (enemy.rewards.crystals) gameState.crystals += enemy.rewards.crystals;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —É–±–∏–π—Å—Ç–≤
                gameState.bossKills[enemy.id] = (gameState.bossKills[enemy.id] || 0) + 1;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–≤–µ—Å—Ç–∞
                updateQuestProgress("battle", 1);
                
                addBattleLog(`üéâ –ü–æ–±–µ–¥–∞! –ü–æ–ª—É—á–µ–Ω–æ: ${enemy.rewards.gold} –∑–æ–ª–æ—Ç–∞, ${enemy.rewards.xp} –æ–ø—ã—Ç–∞`, "loot");
                
                // –®–∞–Ω—Å –Ω–∞ –¥—Ä–æ–ø –ø—Ä–µ–¥–º–µ—Ç–∞
                if (Math.random() < 0.3) {
                    const itemType = Math.random() < 0.5 ? "armor" : "weapons";
                    const item = ITEM_DATABASE[itemType][Math.floor(Math.random() * 2)]; // common –∏–ª–∏ uncommon
                    gameState.inventory[itemType].push({ ...item, count: 1 });
                    addBattleLog(`–ü–æ–ª—É—á–µ–Ω –ø—Ä–µ–¥–º–µ—Ç: ${item.name}`, "loot");
                }
                
                checkLevelUp();
                
            } else {
                addBattleLog("‚ò†Ô∏è –í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏ –±–∏—Ç–≤—É...", "damage");
            }
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–µ–º–Ω–æ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è –ø–æ—Å–ª–µ –±–∏—Ç–≤—ã
            gameState.stats.health = Math.max(1, currentBattle.playerHealth);
            
            // –°–∫—Ä—ã–≤–∞–µ–º –±–æ–µ–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            setTimeout(() => {
                document.getElementById('battleContainer').style.display = 'none';
                currentBattle = null;
                
                // –î–æ–±–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥
                if (playerWon) {
                    addLog(`‚öîÔ∏è –ü–æ–±–µ–¥–∞ –Ω–∞–¥ ${enemy.name}! –ü–æ–ª—É—á–µ–Ω–æ ${enemy.rewards.xp} –æ–ø—ã—Ç–∞.`, "loot");
                } else {
                    addLog(`‚öîÔ∏è –ü–æ—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç ${enemy.name}. –ù—É–∂–Ω–æ —Å—Ç–∞—Ç—å —Å–∏–ª—å–Ω–µ–µ!`, "damage");
                }
                
                updateUI();
            }, 2000);
        }

        function addBattleLog(message, type) {
            const logContainer = document.getElementById('battleLogContainer');
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.textContent = message;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }

        // ==================== –°–ò–°–¢–ï–ú–ê –°–£–ù–î–£–ö–û–í ====================
        function showChests() {
            const modalContent = `
                <div class="modal">
                    <div class="modal-header">
                        <div class="modal-title">üèÜ –ú–∞–≥–∞–∑–∏–Ω —Å—É–Ω–¥—É–∫–æ–≤</div>
                        <button class="close-modal" onclick="closeModal()">√ó</button>
                    </div>
                    <div class="section-title">–í—ã–±–µ—Ä–∏—Ç–µ —Å—É–Ω–¥—É–∫</div>
                    <div class="chest-grid">
                        ${CHEST_TYPES.map(chest => `
                            <div class="chest chest-${chest.rarity}" onclick="openChest('${chest.id}')">
                                <div class="chest-icon">${chest.icon}</div>
                                <div class="chest-name">${chest.name}</div>
                                <div class="chest-cost">${chest.cost} –∑–æ–ª–æ—Ç–∞</div>
                                <div style="font-size: 12px; margin-top: 10px; color: #a9b7c6;">
                                    ${getChestDescription(chest)}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            showModal(modalContent);
        }

        function getChestDescription(chest) {
            const rewards = chest.rewards;
            let desc = "–í–Ω—É—Ç—Ä–∏: ";
            const parts = [];
            
            if (rewards.gold) parts.push("–∑–æ–ª–æ—Ç–æ");
            if (rewards.essence) parts.push("—ç—Å—Å–µ–Ω—Ü–∏—è");
            if (rewards.crystals) parts.push("–∫—Ä–∏—Å—Ç–∞–ª–ª—ã");
            if (rewards.items) parts.push("–ø—Ä–µ–¥–º–µ—Ç—ã");
            
            return desc + parts.join(", ");
        }

        function openChest(chestId) {
            const chest = CHEST_TYPES.find(c => c.id === chestId);
            
            if (!chest) return;
            
            if (gameState.gold < chest.cost) {
                showNotification("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–∞!");
                return;
            }
            
            // –°–ø–∏—Å—ã–≤–∞–µ–º –∑–æ–ª–æ—Ç–æ
            gameState.gold -= chest.cost;
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–∞–≥—Ä–∞–¥—ã
            const rewards = generateChestRewards(chest);
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –Ω–∞–≥—Ä–∞–¥—ã
            rewards.forEach(reward => {
                if (reward.type === "gold") gameState.gold += reward.amount;
                else if (reward.type === "essence") gameState.essence += reward.amount;
                else if (reward.type === "crystals") gameState.crystals += reward.amount;
                else if (reward.type === "item") {
                    const existingItem = gameState.inventory[reward.item.category]?.find(i => i.id === reward.item.id);
                    if (existingItem) {
                        existingItem.count += 1;
                    } else {
                        gameState.inventory[reward.item.category].push({ ...reward.item, count: 1 });
                    }
                }
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞–≥—Ä–∞–¥—ã
            showChestRewards(chest, rewards);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–≤–µ—Å—Ç–∞
            updateQuestProgress("chest", 1);
            
            updateUI();
        }

        function generateChestRewards(chest) {
            const rewards = [];
            const rewardTypes = chest.rewards;
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∑–æ–ª–æ—Ç–æ
            if (rewardTypes.gold) {
                const [min, max] = rewardTypes.gold;
                const amount = Math.floor(Math.random() * (max - min + 1)) + min;
                rewards.push({ type: "gold", amount });
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —ç—Å—Å–µ–Ω—Ü–∏—é
            if (rewardTypes.essence) {
                const [min, max] = rewardTypes.essence;
                const amount = Math.floor(Math.random() * (max - min + 1)) + min;
                rewards.push({ type: "essence", amount });
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫—Ä–∏—Å—Ç–∞–ª–ª—ã
            if (rewardTypes.crystals) {
                const [min, max] = rewardTypes.crystals;
                const amount = Math.floor(Math.random() * (max - min + 1)) + min;
                rewards.push({ type: "crystals", amount });
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–µ–¥–º–µ—Ç—ã
            if (rewardTypes.items) {
                const rarityRoll = Math.random() * 100;
                let selectedRarity = "common";
                
                for (const [rarity, chance] of Object.entries(rewardTypes.items)) {
                    if (rarityRoll <= chance) {
                        selectedRarity = rarity;
                        break;
                    }
                }
                
                // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ä–µ–¥–∫–æ—Å—Ç–∏
                const itemCategories = ["head", "chest", "weapons"];
                const category = itemCategories[Math.floor(Math.random() * itemCategories.length)];
                const itemsOfRarity = ITEM_DATABASE[category].filter(item => item.rarity === selectedRarity);
                
                if (itemsOfRarity.length > 0) {
                    const item = itemsOfRarity[Math.floor(Math.random() * itemsOfRarity.length)];
                    rewards.push({ 
                        type: "item", 
                        item: { ...item, category: category === "weapons" ? "weapons" : "armor" } 
                    });
                }
            }
            
            return rewards;
        }

        function showChestRewards(chest, rewards) {
            let rewardText = `–í—ã –æ—Ç–∫—Ä—ã–ª–∏ ${chest.name}!\n\n–ù–∞–≥—Ä–∞–¥—ã:\n`;
            
            rewards.forEach(reward => {
                if (reward.type === "gold") rewardText += `üí∞ ${reward.amount} –∑–æ–ª–æ—Ç–∞\n`;
                else if (reward.type === "essence") rewardText += `‚ú® ${reward.amount} —ç—Å—Å–µ–Ω—Ü–∏–∏\n`;
                else if (reward.type === "crystals") rewardText += `üîÆ ${reward.amount} –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤\n`;
                else if (reward.type === "item") rewardText += `${reward.item.icon} ${reward.item.name}\n`;
            });
            
            showNotification(rewardText, 5000);
            addLog(`üéÅ –û—Ç–∫—Ä—ã—Ç ${chest.name}! –ü–æ–ª—É—á–µ–Ω—ã —Å–æ–∫—Ä–æ–≤–∏—â–∞.`, "loot");
        }

        // ==================== –°–ò–°–¢–ï–ú–ê –ò–ù–í–ï–ù–¢–ê–†–Ø ====================
        function switchTab(tabName) {
            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
            document.querySelectorAll('.inventory-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
            updateInventory(tabName);
        }

        function updateInventory(category = 'armor') {
            const inventoryContent = document.getElementById('inventoryContent');
            
            let items = [];
            switch(category) {
                case 'armor':
                    items = gameState.inventory.armor;
                    break;
                case 'weapons':
                    items = gameState.inventory.weapons;
                    break;
                case 'potions':
                    items = gameState.inventory.potions;
                    break;
                case 'materials':
                    items = gameState.inventory.materials;
                    break;
            }
            
            if (items.length === 0) {
                inventoryContent.innerHTML = `<div style="text-align: center; padding: 50px; color: #666;">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç</div>`;
                return;
            }
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø—Ä–µ–¥–º–µ—Ç—ã –ø–æ ID
            const groupedItems = {};
            items.forEach(item => {
                if (!groupedItems[item.id]) {
                    groupedItems[item.id] = { ...item, count: 0 };
                }
                groupedItems[item.id].count += item.count || 1;
            });
            
            const itemList = Object.values(groupedItems);
            
            inventoryContent.innerHTML = `
                <div class="item-grid">
                    ${itemList.map(item => `
                        <div class="item-slot item-rarity-${item.rarity}" 
                             onclick="showItemDetails('${item.id}', '${category}')"
                             onmouseover="showTooltip(event, getItemTooltip('${item.id}', '${category}'))"
                             onmouseout="hideTooltip()">
                            <div class="item-icon">${item.icon}</div>
                            <div class="item-name">${item.name}</div>
                            ${item.count > 1 ? `<div class="item-count">${item.count}</div>` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function showItemDetails(itemId, category) {
            let item;
            
            // –ò—â–µ–º –ø—Ä–µ–¥–º–µ—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
            switch(category) {
                case 'armor':
                    item = ITEM_DATABASE.head.concat(ITEM_DATABASE.chest).find(i => i.id === itemId) ||
                           gameState.inventory.armor.find(i => i.id === itemId);
                    break;
                case 'weapons':
                    item = ITEM_DATABASE.weapons.find(i => i.id === itemId) ||
                           gameState.inventory.weapons.find(i => i.id === itemId);
                    break;
                case 'potions':
                    item = ITEM_DATABASE.potions.find(i => i.id === itemId) ||
                           gameState.inventory.potions.find(i => i.id === itemId);
                    break;
                case 'materials':
                    item = ITEM_DATABASE.materials.find(i => i.id === itemId) ||
                           gameState.inventory.materials.find(i => i.id === itemId);
                    break;
            }
            
            if (!item) return;
            
            const modalContent = `
                <div class="modal">
                    <div class="modal-header">
                        <div class="modal-title">${item.icon} ${item.name}</div>
                        <button class="close-modal" onclick="closeModal()">√ó</button>
                    </div>
                    
                    <div style="text-align: center; margin: 20px 0;">
                        <div style="font-size: 60px;">${item.icon}</div>
                        <div style="color: ${getRarityColor(item.rarity)}; margin: 10px 0;">
                            ${getRarityName(item.rarity)}
                        </div>
                    </div>
                    
                    ${item.stats ? `
                        <div style="margin: 20px 0;">
                            <div style="color: #ff8a00; margin-bottom: 10px;">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:</div>
                            ${Object.entries(item.stats).map(([stat, value]) => `
                                <div style="display: flex; justify-content: space-between; margin: 5px 0;">
                                    <span>${getStatName(stat)}:</span>
                                    <span style="color: #4dffea;">+${value}</span>
                                </div>
                            `).join('')}
                        </div>
                    ` : ''}
                    
                    ${item.effect ? `
                        <div style="margin: 20px 0;">
                            <div style="color: #ff8a00; margin-bottom: 10px;">–≠—Ñ—Ñ–µ–∫—Ç:</div>
                            <div>${getEffectDescription(item.effect)}</div>
                        </div>
                    ` : ''}
                    
                    <div style="margin: 20px 0; color: #a9b7c6;">
                        ${item.description || "–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ø—Ä–µ–¥–º–µ—Ç –¥—Ä–µ–≤–Ω–∏—Ö –¥—Ä–∞–∫–æ–Ω–æ–≤."}
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 30px;">
                        ${category === 'armor' || category === 'weapons' ? `
                            <button onclick="equipItem('${itemId}', '${category}')" 
                                    style="flex: 1; padding: 15px; background: linear-gradient(45deg, #00b894, #00cec9); border: none; border-radius: 10px; color: white; cursor: pointer;">
                                –≠–∫–∏–ø–∏—Ä–æ–≤–∞—Ç—å
                            </button>
                        ` : ''}
                        
                        ${category === 'potions' ? `
                            <button onclick="usePotion('${itemId}')" 
                                    style="flex: 1; padding: 15px; background: linear-gradient(45deg, #3742fa, #5352ed); border: none; border-radius: 10px; color: white; cursor: pointer;">
                                –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
                            </button>
                        ` : ''}
                        
                        <button onclick="sellItem('${itemId}', '${category}')" 
                                style="flex: 1; padding: 15px; background: linear-gradient(45deg, #ff4757, #ff6b81); border: none; border-radius: 10px; color: white; cursor: pointer;">
                            –ü—Ä–æ–¥–∞—Ç—å –∑–∞ ${Math.floor((item.price || 50) * 0.7)} –∑–æ–ª–æ—Ç–∞
                        </button>
                    </div>
                </div>
            `;
            
            showModal(modalContent);
        }

        function getItemTooltip(itemId, category) {
            // –í–æ–∑–≤—Ä–∞—â–∞–µ–º HTML –¥–ª—è —Ç—É–ª—Ç–∏–ø–∞
            return `<div class="tooltip">
                <div class="tooltip-title">–ü—Ä–µ–¥–º–µ—Ç</div>
                <div class="tooltip-description">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</div>
            </div>`;
        }

        // ==================== –°–ò–°–¢–ï–ú–ê –≠–ö–ò–ü–ò–†–û–í–ö–ò ====================
        function equipItem(itemId, category) {
            let item;
            let slot;
            
            // –ù–∞—Ö–æ–¥–∏–º –ø—Ä–µ–¥–º–µ—Ç –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ
            if (category === 'armor') {
                const armorItem = gameState.inventory.armor.find(i => i.id === itemId);
                if (!armorItem) return;
                
                item = armorItem;
                
                // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Å–ª–æ—Ç –ø–æ —Ç–∏–ø—É –ø—Ä–µ–¥–º–µ—Ç–∞
                if (itemId.includes('helmet')) slot = 'head';
                else if (itemId.includes('chest')) slot = 'chest';
                else if (itemId.includes('legs')) slot = 'legs';
                else slot = 'chest'; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
                
            } else if (category === 'weapons') {
                const weaponItem = gameState.inventory.weapons.find(i => i.id === itemId);
                if (!weaponItem) return;
                
                item = weaponItem;
                slot = 'weapon';
            }
            
            if (!item || !slot) return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —É—Ä–æ–≤–µ–Ω—å –ø—Ä–µ–¥–º–µ—Ç–∞
            if (item.level > gameState.level) {
                showNotification(`–¢—Ä–µ–±—É–µ—Ç—Å—è —É—Ä–æ–≤–µ–Ω—å ${item.level} –¥–ª—è —ç–∫–∏–ø–∏—Ä–æ–≤–∫–∏!`);
                return;
            }
            
            // –°–Ω–∏–º–∞–µ–º —Å—Ç–∞—Ä—ã–π –ø—Ä–µ–¥–º–µ—Ç, –µ—Å–ª–∏ –µ—Å—Ç—å
            const oldItem = gameState.equipment[slot];
            if (oldItem) {
                // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –ø—Ä–µ–¥–º–µ—Ç –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å
                const existingItem = gameState.inventory[category].find(i => i.id === oldItem.id);
                if (existingItem) {
                    existingItem.count += 1;
                } else {
                    gameState.inventory[category].push({ ...oldItem, count: 1 });
                }
            }
            
            // –≠–∫–∏–ø–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç
            gameState.equipment[slot] = item;
            
            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥–º–µ—Ç –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            const itemIndex = gameState.inventory[category].findIndex(i => i.id === itemId);
            if (itemIndex !== -1) {
                if (gameState.inventory[category][itemIndex].count > 1) {
                    gameState.inventory[category][itemIndex].count -= 1;
                } else {
                    gameState.inventory[category].splice(itemIndex, 1);
                }
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
            updateStatsFromEquipment();
            
            showNotification(`–ü—Ä–µ–¥–º–µ—Ç "${item.name}" —ç–∫–∏–ø–∏—Ä–æ–≤–∞–Ω!`);
            closeModal();
            updateUI();
            updateInventory(category);
        }

        function updateStatsFromEquipment() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –±–æ–Ω—É—Å—ã –æ—Ç —ç–∫–∏–ø–∏—Ä–æ–≤–∫–∏
            const baseStats = {
                attack: 150,
                defense: 75,
                health: 1000,
                maxHealth: 1000,
                speed: 120,
                critical: 15,
                dodge: 10,
                armor: 0,
                fireDamage: 50
            };
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º –±–æ–Ω—É—Å—ã –æ—Ç —ç–∫–∏–ø–∏—Ä–æ–≤–∫–∏
            Object.values(gameState.equipment).forEach(item => {
                if (item && item.stats) {
                    Object.entries(item.stats).forEach(([stat, value]) => {
                        if (stat in baseStats) {
                            baseStats[stat] += value;
                        }
                    });
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—ã –∏–≥—Ä–æ–∫–∞
            Object.assign(gameState.stats, baseStats);
        }

        // ==================== –°–ò–°–¢–ï–ú–ê –ó–ê–î–ê–ù–ò–ô ====================
        function showQuests() {
            const modalContent = `
                <div class="modal">
                    <div class="modal-header">
                        <div class="modal-title">üìú –ó–∞–¥–∞–Ω–∏—è</div>
                        <button class="close-modal" onclick="closeModal()">√ó</button>
                    </div>
                    
                    <div class="quest-list">
                        ${gameState.activeQuests.map(quest => `
                            <div class="quest-item">
                                <div class="quest-header">
                                    <div class="quest-name">${quest.name}</div>
                                    <div class="quest-reward">
                                        ${quest.rewards.gold ? `üí∞${quest.rewards.gold} ` : ''}
                                        ${quest.rewards.xp ? `‚≠ê${quest.rewards.xp} ` : ''}
                                    </div>
                                </div>
                                <div>${quest.description}</div>
                                <div class="quest-progress">
                                    <div class="quest-progress-bar" style="width: ${(quest.progress / quest.required) * 100}%"></div>
                                </div>
                                <div style="text-align: center; margin-top: 10px;">
                                    ${quest.progress}/${quest.required}
                                    ${quest.progress >= quest.required ? 
                                        `<button onclick="completeQuest('${quest.id}')" style="margin-left: 10px; padding: 5px 15px; background: #2ed573; border: none; border-radius: 5px; color: white; cursor: pointer;">
                                            –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É
                                        </button>` : 
                                        ''
                                    }
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            showModal(modalContent);
        }

        function updateQuestProgress(type, amount = 1) {
            gameState.activeQuests.forEach(quest => {
                if (quest.type === type && !quest.completed) {
                    quest.progress = Math.min(quest.progress + amount, quest.required);
                    
                    if (quest.progress >= quest.required) {
                        showNotification(`–ó–∞–¥–∞–Ω–∏–µ "${quest.name}" –≥–æ—Ç–æ–≤–æ –∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é!`);
                    }
                }
            });
        }

        function completeQuest(questId) {
            const questIndex = gameState.activeQuests.findIndex(q => q.id === questId);
            if (questIndex === -1) return;
            
            const quest = gameState.activeQuests[questIndex];
            
            if (quest.progress < quest.required) {
                showNotification("–ó–∞–¥–∞–Ω–∏–µ –µ—â–µ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!");
                return;
            }
            
            // –í—ã–¥–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É
            const rewards = quest.rewards;
            
            if (rewards.gold) gameState.gold += rewards.gold;
            if (rewards.xp) {
                gameState.xp += rewards.xp;
                checkLevelUp();
            }
            if (rewards.essence) gameState.essence += rewards.essence;
            if (rewards.crystals) gameState.crystals += rewards.crystals;
            if (rewards.item) {
                const item = Object.values(ITEM_DATABASE).flat().find(i => i.id === rewards.item);
                if (item) {
                    const category = ITEM_DATABASE.head.includes(item) ? "armor" : 
                                    ITEM_DATABASE.chest.includes(item) ? "armor" : 
                                    ITEM_DATABASE.weapons.includes(item) ? "weapons" : "materials";
                    gameState.inventory[category].push({ ...item, count: 1 });
                }
            }
            
            // –ü–æ–º–µ—á–∞–µ–º –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ
            quest.completed = true;
            gameState.completedQuests.push(quest.id);
            
            // –£–¥–∞–ª—è–µ–º –∏–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∏–ª–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
            if (quest.repeatable) {
                quest.progress = 0;
            } else {
                gameState.activeQuests.splice(questIndex, 1);
            }
            
            showNotification(`–ó–∞–¥–∞–Ω–∏–µ "${quest.name}" –∑–∞–≤–µ—Ä—à–µ–Ω–æ! –ü–æ–ª—É—á–µ–Ω–∞ –Ω–∞–≥—Ä–∞–¥–∞.`);
            closeModal();
            updateUI();
        }

        // ==================== –°–ò–°–¢–ï–ú–ê –£–†–û–í–ù–ï–ô ====================
        function checkLevelUp() {
            while (gameState.xp >= gameState.xpToNextLevel) {
                gameState.xp -= gameState.xpToNextLevel;
                gameState.level++;
                
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –æ–ø—ã—Ç –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è
                gameState.xpToNextLevel = Math.floor(gameState.xpToNextLevel * 1.5);
                
                // –£–ª—É—á—à–∞–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
                gameState.stats.attack += 10;
                gameState.stats.defense += 5;
                gameState.stats.maxHealth += 50;
                gameState.stats.health = gameState.stats.maxHealth;
                gameState.stats.speed += 5;
                
                // –î–∞–µ–º –æ—á–∫–∏ –Ω–∞–≤—ã–∫–æ–≤
                gameState.skillPoints += 3;
                
                // –û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
                if (gameState.level % 5 === 0) {
                    unlockNewTechnology();
                }
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                showLevelUpNotification();
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
                checkAchievements();
            }
            
            updateUI();
        }

        function showLevelUpNotification() {
            showNotification(`üéâ –£—Ä–æ–≤–µ–Ω—å –ø–æ–≤—ã—à–µ–Ω! –¢–µ–ø–µ—Ä—å –≤—ã —É—Ä–æ–≤–µ–Ω—å ${gameState.level}!`, 3000);
            addLog(`üåü –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ ${gameState.level} —É—Ä–æ–≤–Ω—è!`, "loot");
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø–∞–ø –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è
            if (gameState.level % 10 === 0) {
                showAchievementPopup({
                    name: `–ú–∞—Å—Ç–µ—Ä —É—Ä–æ–≤–Ω—è ${gameState.level}`,
                    description: `–î–æ—Å—Ç–∏–≥–Ω—É—Ç —É—Ä–æ–≤–µ–Ω—å ${gameState.level}!`,
                    icon: "üèÜ"
                });
            }
        }

        // ==================== –°–ò–°–¢–ï–ú–ê –î–û–°–¢–ò–ñ–ï–ù–ò–ô ====================
        function checkAchievements() {
            const newAchievements = [
                { 
                    id: "level_10", 
                    name: "–û–ø—ã—Ç–Ω—ã–π –¥—Ä–∞–∫–æ–Ω", 
                    description: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 10 —É—Ä–æ–≤–Ω—è", 
                    condition: () => gameState.level >= 10,
                    reward: 1000
                },
                { 
                    id: "gold_10000", 
                    name: "–ë–æ–≥–∞—á", 
                    description: "–°–æ–±–µ—Ä–∏—Ç–µ 10,000 –∑–æ–ª–æ—Ç–∞", 
                    condition: () => gameState.gold >= 10000,
                    reward: 2000
                },
                { 
                    id: "boss_slayer", 
                    name: "–£–±–∏–π—Ü–∞ –±–æ—Å—Å–æ–≤", 
                    description: "–ü–æ–±–µ–¥–∏—Ç–µ 50 –±–æ—Å—Å–æ–≤", 
                    condition: () => Object.values(gameState.bossKills).reduce((a, b) => a + b, 0) >= 50,
                    reward: 5000
                }
            ];
            
            newAchievements.forEach(achievement => {
                if (!gameState.achievements.find(a => a.id === achievement.id) && 
                    achievement.condition()) {
                    
                    gameState.achievements.push({
                        ...achievement,
                        earned: true
                    });
                    
                    // –í—ã–¥–∞–µ–º –Ω–∞–≥—Ä–∞–¥—É
                    gameState.gold += achievement.reward;
                    
                    showAchievementPopup({
                        name: achievement.name,
                        description: achievement.description,
                        icon: "üèÜ"
                    });
                }
            });
        }

        function showAchievementPopup(achievement) {
            const popup = document.getElementById('achievementPopup');
            popup.innerHTML = `
                <div class="achievement-icon">${achievement.icon}</div>
                <div style="font-size: 24px; font-weight: bold; margin-bottom: 10px;">–î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ!</div>
                <div style="font-size: 18px; margin-bottom: 5px;">${achievement.name}</div>
                <div style="color: #666; margin-bottom: 20px;">${achievement.description}</div>
                <div style="color: #ffd700; font-weight: bold;">–ù–∞–≥—Ä–∞–¥–∞ –ø–æ–ª—É—á–µ–Ω–∞!</div>
            `;
            
            popup.style.display = 'block';
            
            setTimeout(() => {
                popup.style.display = 'none';
            }, 5000);
        }

        // ==================== –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        function updateUI() {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–µ—Å—É—Ä—Å—ã
            document.getElementById('gold').textContent = gameState.gold;
            document.getElementById('essence').textContent = gameState.essence;
            document.getElementById('crystals').textContent = gameState.crystals;
            document.getElementById('energy').textContent = `${gameState.energy}/${gameState.maxEnergy}`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥—Ä–∞–∫–æ–Ω–∞
            document.getElementById('dragonName').textContent = gameState.dragonName;
            document.getElementById('dragonLevel').textContent = gameState.level;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—ã
            document.getElementById('statAttack').textContent = gameState.stats.attack;
            document.getElementById('statDefense').textContent = gameState.stats.defense;
            document.getElementById('statHealth').textContent = `${gameState.stats.health}/${gameState.stats.maxHealth}`;
            document.getElementById('statSpeed').textContent = gameState.stats.speed;
            document.getElementById('statCrit').textContent = `${gameState.stats.critical}%`;
            document.getElementById('statDodge').textContent = `${gameState.stats.dodge}%`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —ç–∫–∏–ø–∏—Ä–æ–≤–∫—É
            updateEquipmentDisplay();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É –¥—Ä–∞–∫–æ–Ω–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Ä–æ–≤–Ω—è
            updateDragonIcon();
        }

        function updateEquipmentDisplay() {
            const slots = ['head', 'chest', 'legs', 'weapon'];
            slots.forEach(slot => {
                const item = gameState.equipment[slot];
                document.getElementById(`equip${slot.charAt(0).toUpperCase() + slot.slice(1)}`).textContent = 
                    item ? item.name : '-';
            });
        }

        function updateDragonIcon() {
            const icon = document.getElementById('dragonIcon');
            let newIcon = 'üêâ';
            
            if (gameState.level >= 30) newIcon = 'üê≤üî•';
            else if (gameState.level >= 20) newIcon = 'üê≤‚ú®';
            else if (gameState.level >= 10) newIcon = 'üê≤';
            
            icon.textContent = newIcon;
        }

        function addLog(message, type = "info") {
            const log = document.getElementById('battleLog');
            const entry = document.createElement('div');
            entry.className = `log-entry log-${type}`;
            entry.textContent = message;
            log.appendChild(entry);
            log.scrollTop = log.scrollHeight;
        }

        function showNotification(message, duration = 3000) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, duration);
        }

        function showModal(content) {
            const overlay = document.getElementById('modalOverlay');
            overlay.innerHTML = content;
            overlay.style.display = 'flex';
        }

        function closeModal() {
            const overlay = document.getElementById('modalOverlay');
            overlay.style.display = 'none';
        }

        function getRarityColor(rarity) {
            const colors = {
                common: '#a9b7c6',
                uncommon: '#2ed573',
                rare: '#3742fa',
                epic: '#9b59b6',
                legendary: '#f1c40f',
                mythical: '#e74c3c'
            };
            return colors[rarity] || '#a9b7c6';
        }

        function getRarityName(rarity) {
            const names = {
                common: '–û–±—ã—á–Ω—ã–π',
                uncommon: '–ù–µ–æ–±—ã—á–Ω—ã–π',
                rare: '–†–µ–¥–∫–∏–π',
                epic: '–≠–ø–∏—á–µ—Å–∫–∏–π',
                legendary: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π',
                mythical: '–ú–∏—Ñ–∏—á–µ—Å–∫–∏–π'
            };
            return names[rarity] || '–û–±—ã—á–Ω—ã–π';
        }

        function getStatName(stat) {
            const names = {
                attack: '–ê—Ç–∞–∫–∞',
                defense: '–ó–∞—â–∏—Ç–∞',
                health: '–ó–¥–æ—Ä–æ–≤—å–µ',
                speed: '–°–∫–æ—Ä–æ—Å—Ç—å',
                critical: '–ö—Ä–∏—Ç. —à–∞–Ω—Å',
                dodge: '–£–∫–ª–æ–Ω–µ–Ω–∏–µ',
                armor: '–ë—Ä–æ–Ω—è',
                fireDamage: '–û–≥–Ω–µ–Ω–Ω—ã–π —É—Ä–æ–Ω',
                fireResist: '–°–æ–ø—Ä. –æ–≥–Ω—é',
                iceResist: '–°–æ–ø—Ä. –ª—å–¥—É',
                allResist: '–í—Å–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è',
                armorPen: '–ü—Ä–æ–±–∏–≤–∞–Ω–∏–µ –±—Ä–æ–Ω–∏',
                allDamage: '–í–µ—Å—å —É—Ä–æ–Ω'
            };
            return names[stat] || stat;
        }

        function getEffectDescription(effect) {
            const descriptions = [];
            
            for (const [key, value] of Object.entries(effect)) {
                if (key === 'health') descriptions.push(`–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç ${value} –∑–¥–æ—Ä–æ–≤—å—è`);
                else if (key === 'attack') descriptions.push(`–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∞—Ç–∞–∫—É –Ω–∞ ${value} –Ω–∞ 5 –º–∏–Ω—É—Ç`);
                else if (key === 'defense') descriptions.push(`–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –∑–∞—â–∏—Ç—É –Ω–∞ ${value} –Ω–∞ 5 –º–∏–Ω—É—Ç`);
                else if (key === 'speed') descriptions.push(`–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–∫–æ—Ä–æ—Å—Ç—å –Ω–∞ ${value} –Ω–∞ 3 –º–∏–Ω—É—Ç—ã`);
                else if (key === 'allStats') descriptions.push(`–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤—Å–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –Ω–∞ ${value} –Ω–∞ 10 –º–∏–Ω—É—Ç`);
                else if (key === 'duration') continue;
                else descriptions.push(`${key}: ${value}`);
            }
            
            return descriptions.join(', ');
        }

        function sellItem(itemId, category) {
            // –ù–∞—Ö–æ–¥–∏–º –ø—Ä–µ–¥–º–µ—Ç
            let item;
            let itemList;
            
            switch(category) {
                case 'armor':
                    itemList = gameState.inventory.armor;
                    break;
                case 'weapons':
                    itemList = gameState.inventory.weapons;
                    break;
                case 'potions':
                    itemList = gameState.inventory.potions;
                    break;
                case 'materials':
                    itemList = gameState.inventory.materials;
                    break;
            }
            
            item = itemList.find(i => i.id === itemId);
            if (!item) return;
            
            // –ü—Ä–æ–¥–∞–∂–Ω–∞—è —Ü–µ–Ω–∞ - 70% –æ—Ç –æ–±—ã—á–Ω–æ–π
            const sellPrice = Math.floor((item.price || 50) * 0.7);
            
            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥–º–µ—Ç –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            const itemIndex = itemList.findIndex(i => i.id === itemId);
            if (itemIndex !== -1) {
                if (itemList[itemIndex].count > 1) {
                    itemList[itemIndex].count -= 1;
                } else {
                    itemList.splice(itemIndex, 1);
                }
            }
            
            // –î–∞–µ–º –∑–æ–ª–æ—Ç–æ
            gameState.gold += sellPrice;
            
            showNotification(`–ü—Ä–µ–¥–º–µ—Ç "${item.name}" –ø—Ä–æ–¥–∞–Ω –∑–∞ ${sellPrice} –∑–æ–ª–æ—Ç–∞!`);
            closeModal();
            updateUI();
            updateInventory(category);
        }

        function usePotion(potionId) {
            const potion = gameState.inventory.potions.find(p => p.id === potionId);
            if (!potion) return;
            
            // –ü—Ä–∏–º–µ–Ω—è–µ–º —ç—Ñ—Ñ–µ–∫—Ç
            if (potion.effect) {
                Object.entries(potion.effect).forEach(([key, value]) => {
                    if (key === 'health') {
                        gameState.stats.health = Math.min(
                            gameState.stats.maxHealth, 
                            gameState.stats.health + value
                        );
                        addLog(`‚ù§Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∑–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ ${value} HP.`, "heal");
                    }
                    // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥—Ä—É–≥–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã
                });
            }
            
            // –£–¥–∞–ª—è–µ–º –∑–µ–ª—å–µ –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
            const potionIndex = gameState.inventory.potions.findIndex(p => p.id === potionId);
            if (potionIndex !== -1) {
                if (gameState.inventory.potions[potionIndex].count > 1) {
                    gameState.inventory.potions[potionIndex].count -= 1;
                } else {
                    gameState.inventory.potions.splice(potionIndex, 1);
                }
            }
            
            showNotification(`–ó–µ–ª—å–µ "${potion.name}" –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ!`);
            closeModal();
            updateUI();
            updateInventory('potions');
        }

        function useSkill(skillName) {
            if (!currentBattle || currentBattle.turn !== "player") return;
            
            const skillLevel = gameState.skills[skillName];
            if (!skillLevel || skillLevel === 0) {
                addBattleLog("–ù–∞–≤—ã–∫ –µ—â–µ –Ω–µ –∏–∑—É—á–µ–Ω!", "info");
                return;
            }
            
            const { enemy } = currentBattle;
            let damage = 0;
            let message = "";
            
            switch(skillName) {
                case "fireBreath":
                    damage = gameState.stats.attack * 1.5 + gameState.stats.fireDamage;
                    message = `üî• –í—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –æ–≥–Ω–µ–Ω–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ –∏ –Ω–∞–Ω–æ—Å–∏—Ç–µ ${damage} —É—Ä–æ–Ω–∞!`;
                    break;
            }
            
            currentBattle.enemyHealth -= damage;
            addBattleLog(message, "damage");
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø–æ–±–µ–∂–¥–µ–Ω –ª–∏ –≤—Ä–∞–≥
            if (currentBattle.enemyHealth <= 0) {
                endBattle(true);
                return;
            }
            
            // –ü–µ—Ä–µ—Ö–æ–¥ —Ö–æ–¥–∞ –∫ –≤—Ä–∞–≥—É
            currentBattle.turn = "enemy";
            setTimeout(enemyTurn, 1000);
            
            updateBattleUI();
        }

        function useDefense() {
            if (!currentBattle || currentBattle.turn !== "player") return;
            
            // –í—Ä–µ–º–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∑–∞—â–∏—Ç—É
            const defenseBoost = gameState.stats.defense * 0.5;
            gameState.stats.defense += defenseBoost;
            
            addBattleLog(`üõ°Ô∏è –í—ã –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ –∑–∞—â–∏—Ç–Ω—É—é —Å—Ç–æ–π–∫—É. –ó–∞—â–∏—Ç–∞ —É–≤–µ–ª–∏—á–µ–Ω–∞ –Ω–∞ ${Math.floor(defenseBoost)}.`, "info");
            
            // –ü–µ—Ä–µ—Ö–æ–¥ —Ö–æ–¥–∞ –∫ –≤—Ä–∞–≥—É
            currentBattle.turn = "enemy";
            setTimeout(() => {
                // –ü–æ—Å–ª–µ —Ö–æ–¥–∞ –≤—Ä–∞–≥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–∞—â–∏—Ç—É
                gameState.stats.defense -= defenseBoost;
                enemyTurn();
            }, 1000);
        }

        // ==================== –°–ò–°–¢–ï–ú–ê –°–û–•–†–ê–ù–ï–ù–ò–Ø ====================
        function saveGame() {
            try {
                const saveData = {
                    ...gameState,
                    saveTime: Date.now()
                };
                
                localStorage.setItem('dragonEvolutionSave', JSON.stringify(saveData));
                showNotification("–ò–≥—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!");
                return true;
            } catch (e) {
                showNotification("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: " + e.message);
                return false;
            }
        }

        function loadGame() {
            try {
                const saveData = JSON.parse(localStorage.getItem('dragonEvolutionSave'));
                
                if (!saveData) {
                    showNotification("–°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–∞—è –∏–≥—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞!");
                    return;
                }
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ
                Object.assign(gameState, saveData);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
                updateUI();
                updateInventory('armor');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                showNotification("–ò–≥—Ä–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!");
                
                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –∏–≥—Ä—É
                document.getElementById('mainMenu').style.display = 'none';
                document.getElementById('gameContainer').style.display = 'block';
                startGameLoop();
                
            } catch (e) {
                showNotification("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: " + e.message);
            }
        }

        function autoSave() {
            if (Math.random() < 0.3) { // 30% —à–∞–Ω—Å –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
                saveGame();
            }
        }

        // ==================== –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò ====================
        function showSettings() {
            const modalContent = `
                <div class="modal">
                    <div class="modal-header">
                        <div class="modal-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                        <button class="close-modal" onclick="closeModal()">√ó</button>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        <div style="margin-bottom: 15px;">
                            <div style="color: #ff8a00; margin-bottom: 5px;">–ì—Ä–æ–º–∫–æ—Å—Ç—å –º—É–∑—ã–∫–∏</div>
                            <input type="range" min="0" max="100" value="50" style="width: 100%;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <div style="color: #ff8a00; margin-bottom: 5px;">–ì—Ä–æ–º–∫–æ—Å—Ç—å –∑–≤—É–∫–æ–≤</div>
                            <input type="range" min="0" max="100" value="70" style="width: 100%;">
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" checked>
                                <span>–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏</span>
                            </label>
                        </div>
                        
                        <div style="margin-bottom: 15px;">
                            <label style="display: flex; align-items: center; gap: 10px;">
                                <input type="checkbox" checked>
                                <span>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö</span>
                            </label>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 30px;">
                        <button onclick="saveGame()" 
                                style="flex: 1; padding: 15px; background: linear-gradient(45deg, #00b894, #00cec9); border: none; border-radius: 10px; color: white; cursor: pointer;">
                            –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä—É
                        </button>
                        
                        <button onclick="confirmReset()" 
                                style="flex: 1; padding: 15px; background: linear-gradient(45deg, #ff4757, #ff6b81); border: none; border-radius: 10px; color: white; cursor: pointer;">
                            –°–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É
                        </button>
                    </div>
                </div>
            `;
            
            showModal(modalContent);
        }

        function showAchievements() {
            const modalContent = `
                <div class="modal">
                    <div class="modal-header">
                        <div class="modal-title">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</div>
                        <button class="close-modal" onclick="closeModal()">√ó</button>
                    </div>
                    
                    <div style="margin: 20px 0;">
                        ${gameState.achievements.map(achievement => `
                            <div style="margin-bottom: 15px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 10px; border-left: 4px solid ${achievement.earned ? '#2ed573' : '#666'}">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <div style="font-weight: bold; color: ${achievement.earned ? '#ff8a00' : '#666'}">
                                            ${achievement.name}
                                        </div>
                                        <div style="color: #a9b7c6; font-size: 14px; margin-top: 5px;">
                                            ${achievement.description}
                                        </div>
                                    </div>
                                    <div style="color: #ffd700; font-weight: bold;">
                                        ${achievement.earned ? `+${achievement.reward} –∑–æ–ª–æ—Ç–∞` : '–ù–µ –ø–æ–ª—É—á–µ–Ω–æ'}
                                    </div>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
            
            showModal(modalContent);
        }

        function showHowToPlay() {
            const modalContent = `
                <div class="modal">
                    <div class="modal-header">
                        <div class="modal-title">‚ùì –û–±—É—á–µ–Ω–∏–µ</div>
                        <button class="close-modal" onclick="closeModal()">√ó</button>
                    </div>
                    
                    <div style="margin: 20px 0; line-height: 1.6;">
                        <h3 style="color: #ff8a00; margin-bottom: 10px;">–û—Å–Ω–æ–≤—ã –∏–≥—Ä—ã:</h3>
                        <p>1. <strong>–û—Ö–æ—Ç–∞</strong> - –æ—Å–Ω–æ–≤–Ω–æ–π —Å–ø–æ—Å–æ–± –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ –æ–ø—ã—Ç–∞</p>
                        <p>2. <strong>–°—É–Ω–¥—É–∫–∏</strong> - —Å–æ–¥–µ—Ä–∂–∞—Ç —Ü–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã –∏ —Ä–µ—Å—É—Ä—Å—ã</p>
                        <p>3. <strong>–ë–∏—Ç–≤—ã</strong> - —Å—Ä–∞–∂–µ–Ω–∏—è —Å –≤—Ä–∞–≥–∞–º–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–∞–≥—Ä–∞–¥</p>
                        <p>4. <strong>–≠–∫–∏–ø–∏—Ä–æ–≤–∫–∞</strong> - —É–ª—É—á—à–∞–µ—Ç —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤–∞—à–µ–≥–æ –¥—Ä–∞–∫–æ–Ω–∞</p>
                        <p>5. <strong>–ó–∞–¥–∞–Ω–∏—è</strong> - –¥–∞—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã</p>
                        
                        <h3 style="color: #ff8a00; margin: 20px 0 10px 0;">–°–æ–≤–µ—Ç—ã –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤:</h3>
                        <p>‚Ä¢ –ù–∞—á–Ω–∏—Ç–µ —Å –æ—Ö–æ—Ç—ã, —á—Ç–æ–±—ã –Ω–∞–±—Ä–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã</p>
                        <p>‚Ä¢ –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ —Å—É–Ω–¥—É–∫–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç–∫–∏–ø–∏—Ä–æ–≤–∫–∏</p>
                        <p>‚Ä¢ –í—ã–ø–æ–ª–Ω—è–π—Ç–µ –∑–∞–¥–∞–Ω–∏—è –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</p>
                        <p>‚Ä¢ –≠–∫–∏–ø–∏—Ä—É–π—Ç–µ –ª—É—á—à–∏–µ –ø—Ä–µ–¥–º–µ—Ç—ã –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è</p>
                        <p>‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–µ–ª—å—è –≤ —Å–ª–æ–∂–Ω—ã—Ö –±–∏—Ç–≤–∞—Ö</p>
                        
                        <div style="margin-top: 30px; padding: 15px; background: rgba(255, 138, 0, 0.1); border-radius: 10px; border-left: 4px solid #ff8a00;">
                            <strong>–û—Å–Ω–æ–≤–∞—Ç–µ–ª—å –∏–≥—Ä—ã:</strong> Agafonov<br>
                            <strong>–í–µ—Ä—Å–∏—è:</strong> 2.0 Dragon Evolution<br>
                            <strong>–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:</strong> –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—â–∞—è RPG —Å —Å–∏—Å—Ç–µ–º–æ–π –∫—Ä–∞—Ñ—Ç–∞, –∫–≤–µ—Å—Ç–∞–º–∏ –∏ —Ä–∞–∑–≤–∏—Ç–∏–µ–º!
                        </div>
                    </div>
                </div>
            `;
            
            showModal(modalContent);
        }

        function confirmReset() {
            if (confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —Å–±—Ä–æ—Å–∏—Ç—å –∏–≥—Ä—É? –í—Å–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –±—É–¥–µ—Ç –ø–æ—Ç–µ—Ä—è–Ω!")) {
                localStorage.removeItem('dragonEvolutionSave');
                location.reload();
            }
        }

        // ==================== –§–£–ù–ö–¶–ò–ò-–ó–ê–ì–õ–£–®–ö–ò ====================
        function showDungeon() {
            showNotification("–ü–æ–¥–∑–µ–º–µ–ª—å—è –æ—Ç–∫—Ä–æ—é—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏!");
        }

        function startTraining() {
            showNotification("–¢—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –∑–∞–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏!");
        }

        function showEnchant() {
            showNotification("–ú–∞—Å—Ç–µ—Ä –∑–∞—á–∞—Ä–æ–≤–∞–Ω–∏–π —Å–∫–æ—Ä–æ –≤–µ—Ä–Ω–µ—Ç—Å—è –∏–∑ –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏—è!");
        }

        function showEvolution() {
            showNotification("–≠–≤–æ–ª—é—Ü–∏—è –¥–æ—Å—Ç—É–ø–Ω–∞ —Å 50 —É—Ä–æ–≤–Ω—è!");
        }

        function showBosses() {
            showNotification("–ê—Ä–µ–Ω–∞ –±–æ—Å—Å–æ–≤ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏!");
        }

        function showClan() {
            showNotification("–°–∏—Å—Ç–µ–º–∞ –∫–ª–∞–Ω–æ–≤ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ!");
        }

        function unlockNewTechnology() {
            showNotification("–û—Ç–∫—Ä—ã—Ç–∞ –Ω–æ–≤–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è!");
        }

        // ==================== –¢–£–õ–¢–ò–ü–´ ====================
        function showTooltip(event, content) {
            let tooltip = document.querySelector('.tooltip');
            if (!tooltip) {
                tooltip = document.createElement('div');
                tooltip.className = 'tooltip';
                document.body.appendChild(tooltip);
            }
            
            tooltip.innerHTML = content;
            tooltip.style.opacity = '1';
            
            const x = event.clientX + 10;
            const y = event.clientY + 10;
            
            tooltip.style.left = x + 'px';
            tooltip.style.top = y + 'px';
        }

        function hideTooltip() {
            const tooltip = document.querySelector('.tooltip');
            if (tooltip) {
                tooltip.style.opacity = '0';
            }
        }

        // ==================== –ó–ê–ü–£–°–ö –ò–ì–†–´ ====================
        // –ó–∞–ø—É—Å–∫–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = simulateLoading;
    </script>
</body>
</html>
